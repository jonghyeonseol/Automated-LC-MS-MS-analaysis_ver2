<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Diagnostic Test</title>
</head>
<body>
    <h1>JavaScript Diagnostic Test</h1>

    <div id="status">Testing JavaScript...</div>

    <button onclick="testBasicFunction()">Test Basic Function</button>
    <button onclick="testAPICall()">Test API Call</button>
    <button onclick="testFileUpload()">Test File Upload</button>

    <div id="results"></div>

    <script>
        console.log('ğŸ”§ JavaScript diagnostic loading...');

        // Test 1: Basic function execution
        function testBasicFunction() {
            console.log('âœ… Basic function executed!');
            document.getElementById('status').textContent = 'âœ… Basic JavaScript working!';
            document.getElementById('results').innerHTML += '<p>âœ… Basic function test passed</p>';
        }

        // Test 2: API call
        async function testAPICall() {
            console.log('ğŸ”Œ Testing API call...');
            document.getElementById('status').textContent = 'ğŸ”Œ Testing API call...';

            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                console.log('âœ… API call successful:', data);
                document.getElementById('status').textContent = 'âœ… API call successful!';
                document.getElementById('results').innerHTML += '<p>âœ… API call test passed: ' + data.status + '</p>';
            } catch (error) {
                console.error('âŒ API call failed:', error);
                document.getElementById('status').textContent = 'âŒ API call failed!';
                document.getElementById('results').innerHTML += '<p>âŒ API call test failed: ' + error.message + '</p>';
            }
        }

        // Test 3: File upload simulation
        function testFileUpload() {
            console.log('ğŸ“ Testing file upload simulation...');
            document.getElementById('status').textContent = 'ğŸ“ File upload test...';

            // Create a test file
            const testContent = 'Name,RT,Volume\nTest1,1.0,1000\nTest2,2.0,2000';
            const testFile = new File([testContent], 'test.csv', { type: 'text/csv' });

            console.log('ğŸ“„ Test file created:', testFile.name, testFile.size, 'bytes');
            document.getElementById('status').textContent = 'âœ… File upload test passed!';
            document.getElementById('results').innerHTML += '<p>âœ… File upload test passed: ' + testFile.name + '</p>';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“‹ DOM loaded successfully');
            document.getElementById('status').textContent = 'ğŸ“‹ DOM loaded, JavaScript ready!';
            document.getElementById('results').innerHTML += '<p>ğŸ“‹ DOM Content Loaded event fired</p>';
        });

        console.log('ğŸš€ JavaScript diagnostic script loaded');
    </script>
</body>
</html>